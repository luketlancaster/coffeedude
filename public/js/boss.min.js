!function(){"use strict";function e(){game.physics.startSystem(Phaser.Physics.ARCADE),x=game.add.audio("explosion"),p=game.add.audio("shoot"),game.world.setBounds(0,0,800,640),game.bg=game.add.tileSprite(0,0,800,640,"bossBG"),y=game.add.tilemap("bossfight"),y.addTilesetImage("steampunk"),y.addTilesetImage("blocks"),y.setCollisionByExclusion([1]),r=y.createLayer("platforms"),r.resizeWorld(),A=game.add.sprite(12,520,"head"),game.physics.enable(A,Phaser.Physics.ARCADE),A.body.collideWorldBounds=!0,A.body.setSize(25,50,19,0),A.body.gravity.y=450,A.animations.add("left",[2]),A.animations.add("right",[1]),n=game.input.keyboard.createCursorKeys(),h=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),game.camera.follow(A,Phaser.Camera.FOLLOW_TOPDOWN_TIGHT),f=game.add.sprite(640,200,"jwb"),game.physics.enable(f,Phaser.Physics.ARCADE),f.animations.add("mad",[0,1],10,!0),f.body.velocity.y=200,u=game.add.group(),u.enableBody=!0,u.createMultiple(5,"bullet"),u.setAll("body.setSize",31,15),c=game.add.group(),c.enableBody=!0,c.createMultiple(2,"bowtie"),c.setAll("body.setSize",64,36),b=game.add.text(20,20,"Local Artists' Vinyl: 0",{fontSize:"32px",fill:"#FFF",align:"center"}),b.fixedToCamera=!0,g=game.add.text(660,20,"Health: 3",{fontSize:"32px",fill:"#FFF"}),g.fixedToCamera=!0;var e={font:"32px Arial",fill:"#fff",wordWrap:!0,wordWrapWidth:f.width,align:"center"};w=game.add.text(0,0,"You'll Never Get Me, Abe!",e),w.anchor.set(.5)}function a(){game.physics.arcade.collide(A,r),game.physics.arcade.collide(f,r),game.physics.arcade.collide(u,r,l,null,this),game.physics.arcade.overlap(u,A,d,null,this),game.physics.arcade.overlap(c,r,i,null,this),game.physics.arcade.overlap(c,f,o,null,this),A.body.velocity.x=0,f.animations.play("mad"),n.left.isDown?(A.body.velocity.x=-250,A.animations.play("left")):n.right.isDown?(A.body.velocity.x=250,A.animations.play("right")):A.frame=0,n.up.isDown&&A.body.onFloor()&&game.time.now>k&&(A.body.velocity.y=-350,k=game.time.now+750),c.forEachAlive(function(e){var a=600;Math.abs(A.x-e.x)>=a&&e.kill()},this),h.isDown&&t(),F=A.body.velocity.x>=0?"right":"left",f.body.blocked.down&&(f.body.velocity.y=-200,D++),f.body.blocked.up&&(f.body.velocity.y=200,D++),f.body.blocked.left&&(f.body.velocity.x=200,D++),f.body.blocked.right&&(f.body.velocity.x=-200,D++),4===D&&(f.body.velocity.y=200,f.body.velocity.x=-200),20===D&&(f.body.velocity.x=0,D=0),game.time.now>S&&(v=u.getFirstExists(!1),v&&(v.reset(f.x,f.y),v.body.velocity.x=-500,S=game.time.now+800,game.physics.arcade.moveToObject(v,A,500))),w.x=Math.floor(f.x+f.width/2)-100,w.y=Math.floor(f.y+f.height/2),2===D&&w.destroy(),E%10===1&&(C++,E++,g.text="Health: "+C),0===C&&s()}function t(){game.time.now>P&&"right"===F?(m=c.getFirstExists(!1),m&&(m.reset(A.x-30,A.y-10),m.body.velocity.x=500,P=game.time.now+350,p.play())):game.time.now>P&&"left"===F&&(m=c.getFirstExists(!1),m&&(m.reset(A.x-30,A.y-10),m.body.velocity.x=-500,P=game.time.now+750,p.play()))}function o(e,a){a.kill(),e.body.velocity.x*=3,e.body.velocity.y*=3}function i(e){e.kill()}function l(e){e.kill()}function d(e,a){e.animations.play("damage"),x.play(),a.kill(),e.body.x-=75,--C,g.text="Health: "+C}function s(){game.state.start("menu"),C=2}game.state.add("boss",{create:e,update:a});var y,r,n,c,m,g,b,h,p,x,f,u,v,w,A,k=0,F="right",P=0,C=3,E=0,D=0,S=0}();